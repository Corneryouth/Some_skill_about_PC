#matlab about some heat transfer in book (chinese book by zhang)
#first  Numerical solution for heat transfer
TLB=200;
TTB=50;
TRB=50;
TBB=50;
Temputer=zeros(7,9);
Draw=zeros(63,3);
A = [4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 -1 4 0 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   -1 0 0 0 0 0 0 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 0 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 -1 0 0 0 0 0 0 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 0 0 0 0 0 0 -1 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 0 4 -1 0 0 0 0 0 -1 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0 0 -1 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 0 0 0 0 0 0 -1;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 0 4 -1 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4 -1;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 4;];
B=[TLB+TBB;TBB;TBB;TBB;TBB;TBB;TBB+TRB;TLB;0;0;0;0;0;TRB;TLB;0;0;0;0;0;
    TRB;TLB;0;0;0;0;0;TRB;TTB+TLB;TTB;TTB;TTB;TTB;TTB;TTB+TRB];
EPS=0.000000001;
IT=0;
K=800;
T0=[0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
n=length(B);
T=zeros(n,1);
for i=1:7
    Temputer(i,1)=120;
    Temputer(i,9)=50;
end
for j=2:8
    Temputer(1,j)=50;
    Temputer(7,j)=50;
end
while IT<K
    for i=1:n
        if i==1
            T(1)=(B(1)-(A(1,2:n)*T0(2:n,1)))/A(1,1);

        elseif i==n
            T(n)=(B(n)-(A(n,1:n-1)*T(1:n-1,1)))/A(n,n);
        else
        T(i)=(B(i)-(A(i,1:i-1)*T(1:i-1,1)+A(i,i+1:n)*T0(i+1:n,1)))/A(i,i);
        end
    end
    
    if norm(T-T0,inf)<EPS
        break;
    end
    T0=T;
    IT=IT+1;
end

T=T';
Tem=reshape(T,7,5);
Tem=Tem';
for i=2:6
    for j=2:8
        Temputer(i,j)=Tem(i-1,j-1); 
    end
end
TX=reshape(Temputer,63,1)
for m=1:63
    Draw(m,3)=TX(m,1);
end
for h=1:9
    for z=1:7
        for p=0:8
        Draw(z+7*p,1)=p+1
        end
    end
end
for q=1:9
    for r=1:7
        for e=0:8
        Draw(r+7*e,2)=r
        end
    end
end
 x= Draw(:,1); y= Draw(:,2); z= Draw(:,3);
figure(1)
scatter3(x,y,z)
figure(2)
scatter(x,y,115,z)
figure(3)
[X,Y,Z]=griddata(x,y,z,linspace(min(x),max(x))',linspace(min(y),max(y)),'v4');%??
pcolor(X,Y,Z);
shading interp;
contourf(X,Y,Z) 
figure(5)
surf(X,Y,Z)
disp(Temputer)
